@{
    ViewData["Title"] = "AI Chat";
    Layout = "_ChatLayout";
}

<div class="chat-container" id="chatContainer" data-theme="dark">
    <!-- Sidebar -->
    <aside class="chat-sidebar">
        <div class="sidebar-header">
            <h2>AI Chat</h2>
            <button class="btn-new-chat" id="newChatBtn" title="New conversation">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path
                    d="M8 0a.5.5 0 0 1 .5.5v7h6.5a.5.5 0 0 1 0 1h-6.5v6.5a.5.5 0 0 1-1 0v-6.5H1a.5.5 0 0 1 0-1h6V.5A.5.5 0 0 1 8 0z" />
                </svg>
            </button>
        </div>

        <div class="conversation-list" id="conversationList">
            <div class="conversation-item active">
                <span class="conversation-title">New Conversation</span>
            </div>
        </div>

        <div class="sidebar-footer">
            <div class="agent-selector">
                <label for="agentSelect">Agent</label>
                <select id="agentSelect" class="form-select">
                    <option value="Writer">Writer - Content creation</option>
                    <option value="Reviewer">Reviewer - Feedback</option>
                    <option value="Code">Code - Programming + GitHub tools</option>
                    <option value="Image">Image - Generation</option>
                    <option value="Video">Video - Generation</option>
                </select>
            </div>

            <div class="mcp-status hidden" id="githubMcpStatus" data-state="disconnected" aria-live="polite">
                <div class="mcp-status-label">MCP (GitHub)</div>
                <div class="mcp-status-value">
                    <span class="mcp-dot" aria-hidden="true"></span>
                    <span id="githubMcpStatusText">Disconnected</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="chat-main">
        <header class="chat-header">
            <div class="agent-info">
                <span class="agent-avatar" id="agentAvatar">W</span>
                <div class="agent-details">
                    <span class="agent-name" id="agentName">Writer</span>
                    <span class="agent-description" id="agentDescription">Content creation</span>
                </div>
            </div>
            <div class="chat-actions">
                <button class="btn-icon" id="clearChatBtn" title="Clear chat">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path
                        d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                        <path fill-rule="evenodd"
                              d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
                    </svg>
                </button>
            </div>
        </header>

        <div class="message-list" id="messageList">
            <div class="welcome-message">
                <div class="welcome-icon">
                    <svg width="48" height="48" viewBox="0 0 16 16" fill="currentColor">
                        <path
                        d="M8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6-.097 1.016-.417 2.13-.771 2.966-.079.186.074.394.273.362 2.256-.37 3.597-.938 4.18-1.234A9.06 9.06 0 0 0 8 15z" />
                    </svg>
                </div>
                <h1>Welcome to AI Chat</h1>
                <p>Select an agent and start a conversation. Your messages will stream in real-time.</p>
                <div class="feature-list">
                    <div class="feature">
                        <span class="feature-icon">S</span>
                        <span>Streaming Responses</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">A</span>
                        <span>Multiple Agents</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">T</span>
                        <span>Tool Calling</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">M</span>
                        <span>Markdown Support</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Typing Indicator -->
        <div class="typing-indicator hidden" id="typingIndicator">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="typing-text">Agent is typing...</span>
        </div>

        <!-- Tool Call Notification -->
        <div class="tool-notification hidden" id="toolNotification">
            <svg class="tool-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path
                d="M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.356 3.356a1 1 0 0 0 1.414 0l1.586-1.586a1 1 0 0 0 0-1.414l-3.356-3.356a1 1 0 0 0-1.023-.242l-.914.305-.968-.968 2.617-2.654A3.003 3.003 0 0 0 13 3.002 3 3 0 0 0 9.878 1.13l-2.654 2.617L4.549 1.07a1 1 0 0 1-.293-.707v-.07a1 1 0 0 0-.419-.815L1 0zm9.646 10.646a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708zM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11z" />
            </svg>
            <span class="tool-name"></span>
            <span class="tool-status">Running...</span>
        </div>

        <!-- Input Area -->
        <div class="chat-input-area">
            <div class="file-preview hidden" id="filePreview">
                <div class="file-preview-list"></div>
            </div>
            <form class="chat-form" id="chatForm">
                <button type="button" class="btn-attach" id="attachBtn" title="Attach file">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path
                        d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z" />
                    </svg>
                </button>
                <input type="file" id="fileInput" class="hidden" accept="image/*" multiple />
                <textarea id="messageInput" placeholder="Type a message... (Enter to send, Shift+Enter for new line)"
                          rows="1"></textarea>
                <button type="submit" class="btn-send" id="sendBtn" title="Send message">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path
                        d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z" />
                    </svg>
                </button>
            </form>
            <div class="input-hint">
                <span>Powered by Azure AI Foundry</span>
            </div>
        </div>
    </main>
</div>